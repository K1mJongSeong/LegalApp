# 📋 LawDecode 기능 정리

> **작성일**: 2026-01-14  
> **프로젝트**: LawDecode - 법률 상담 플랫폼

---

## 🎯 개요

일반 사용자와 법률 전문가를 연결하는 Flutter 기반 하이브리드 앱(모바일/웹)입니다.

---

## 👤 사용자 기능

### 1. 인증 시스템
- ✅ **회원가입/로그인**: 이메일/비밀번호 기반 Firebase 인증
- ✅ **사용자/전문가 구분**: 회원가입 시 일반 사용자 또는 전문가 선택
- ✅ **자동 로그인**: 세션 유지 및 자동 인증 상태 확인

### 2. 법률 상담 등록 플로우
- ✅ **카테고리 선택**: 노동, 세금, 형사, 가사, 부동산 등 법률 분야 선택
- ✅ **사건 진행 상황 입력**: 현재 사건의 진행 단계 선택
- ✅ **상세 내용 입력**: 사건에 대한 상세 설명 작성
- ✅ **상담 목표 선택**: 
  - 손해 회복
  - 법적 판단
  - 원만한 해결
  - 상담만 원함
- ✅ **상담 조건 설정**: 
  - 상담 방법 선택 (전화/방문/온라인)
  - 상담비 설정
  - 무료 상담 여부
- ✅ **긴급도 선택**: 매우 급함 / 보통 / 단순 상담

### 3. GPT 기반 사건 분석
- ✅ **AI 법률 분석**: 
  - 사건 요약 생성
  - 관련 법률 조항 추출
  - 유사 판례 검색
  - 전문가 추천 수 계산
- ✅ **하이브리드 아키텍처**:
  - **모바일**: `.env`에서 API 키 로드 → OpenAI API 직접 호출
  - **웹**: Supabase Edge Function 프록시를 통한 호출 (API 키는 서버에서 관리)
- ✅ **에러 처리**: API 실패 시 기본 응답 반환

### 4. 전문가 목록 및 조회
- ✅ **인증된 전문가만 표시**: `isVerified: true`, `status: "active"` 필터링
- ✅ **전문가 카드 UI**: 
  - 프로필 이미지
  - 이름, 직업, 소속
  - 전문 분야
  - 상담 가능 여부
  - 15분 전화상담 / 방문상담 버튼
  - 연락처 아이콘 (전화/이메일/카카오톡)
- ✅ **전문가 상세 페이지**: 전문가 프로필 상세 정보 조회

### 5. 상담 예약 시스템
- ✅ **15분 전화상담 예약**: 날짜/시간 선택 모달
- ✅ **방문상담 예약**: 날짜/시간 선택 모달
- ✅ **예약 정보 저장**: Firestore `consultation_requests` 컬렉션에 저장
  - 전문가 ID
  - 사용자 ID
  - 상담 유형 (전화/방문)
  - 예약 날짜/시간
  - 상태 (pending/inProgress/completed/cancelled)

### 6. 사건 관리
- ✅ **내 사건 목록**: 사용자가 등록한 사건 목록 조회
- ✅ **사건 상태 관리**: 진행중/대기중/완료 상태별 필터링
- ✅ **사건 상세 조회**: 사건별 상세 정보 및 분석 결과 확인

---

## 👨‍⚖️ 전문가 기능

### 1. 전문가 인증 시스템
- ✅ **전문가 계정 생성**: 전문가 회원가입
- ✅ **인증 제출**: 
  - 서류 인증 (자격증, 사업자등록증 등)
  - 즉시 인증 (간단한 정보 입력)
- ✅ **인증 상태 관리**: `expert_accounts` 컬렉션에서 인증 상태 추적

### 2. 전문가 대시보드
- ✅ **대시보드 홈**: 전문가 전용 메인 화면
- ✅ **상담 요청 목록**: 전문가에게 들어온 상담 요청 조회
- ✅ **상담 상태 관리**: 상담 요청 상태 업데이트

### 3. 전문가 프로필 관리

#### 3.1 필수정보 탭 (Required Information)
- ✅ **기본정보**:
  - 프로필 이미지
  - 이름
  - 직업
  - 소속
  - DB 저장/로드 기능
- ✅ **인적사항**:
  - 생년월일
  - 성별
  - 전화번호
  - 이메일
  - 대표 전화번호 타입
  - DB 저장/로드 기능
- ✅ **학력사항**: 학력 정보 입력 (다중 항목)
- ✅ **주요분야**: 전문 분야 선택 (다중 선택)
- ✅ **사무실 정보**:
  - 소속 지점
  - 지역 (시/도, 시/군/구)
  - 도로명 주소 / 지번 주소

#### 3.2 강조정보 탭 (Highlight Information)
- ✅ **강조 정보 입력**: 전문가를 어필할 수 있는 강조 정보 작성

#### 3.3 추가정보 탭 (Additional Information)
- ✅ **경력사항**: 경력 정보 입력 (다중 항목)
- ✅ **자격사항**: 자격증 정보 입력 (다중 항목)
- ✅ **수상내역**: 수상 정보 입력 (다중 항목)
- ✅ **출판물**: 출판물 정보 입력 (다중 항목)
- ✅ **보도자료**: 보도자료 정보 입력 (다중 항목)
- ✅ **세금계산서 정보**:
  - 세금계산서 유형 (개인/법인)
  - 사업자등록번호
  - 회사명
  - 대표자명
  - 세금계산서 이메일
  - 추가 이메일
- ✅ **기타활동**: 기타 활동 정보 입력 (다중 항목)
  - 시작년도/종료년도
  - 활동 내용
  - 대표 활동 여부
- ✅ **수임료 정보**:
  - 소송 유형
  - 수임료 금액 및 범위 (고정금액/~부터/범위/협의)
  - 성공보수 단위 (금액/비율)
  - 성공보수 값 및 범위
- ✅ **서비스 요금**:
  - 지불방법 선택 (무료상담/할부/후불/카드결제)
  - 서비스 유형 (드롭다운 또는 직접 입력)
  - 단위 (건/시간/일)
  - 금액 및 범위

#### 3.4 간편 문의 탭 (Simple Inquiry)
- ✅ **전화 문의**:
  - 전화 문의 활성화 토글
  - 전화번호 입력
- ✅ **이메일 문의**:
  - 이메일 문의 활성화 토글
  - 이메일 주소 입력
- ✅ **카카오톡 문의**:
  - 카카오톡 문의 활성화 토글
  - 카카오톡 링크 입력

### 4. 프로필 완성률 계산
- ✅ **동적 완성률 계산**: 필수정보 탭의 필수 필드 기반으로 완성률 자동 계산
  - 기본정보 (5개 필드)
  - 인적사항 (5개 필드)
  - 학력사항 (1개 필드)
  - 주요분야 (1개 필드)
  - 사무실 정보 (4개 필드)
- ✅ **실시간 표시**: 
  - 홈 화면 전문가 카드에 완성률 표시
  - 전문가 드로어에 완성률 표시
  - 프로필 관리 페이지에서 완성률 확인

### 5. 전문가 메뉴
- ✅ **소개 페이지**: 전문가 소개 정보 관리
- ✅ **상담 페이지**: 상담 관련 정보 관리
- ✅ **광고 페이지**: 광고 정보 관리
- ✅ **게시글 페이지**: 전문가 게시글 관리
- ✅ **동영상 페이지**: 동영상 콘텐츠 관리
- ✅ **공지사항 페이지**: 공지사항 관리

---

## 🏗️ 기술적 기능

### 1. 상태 관리
- ✅ **BLoC 패턴**: flutter_bloc을 사용한 상태 관리
  - `AuthBloc`: 인증 상태 관리
  - `CaseBloc`: 사건 상태 관리
  - `ExpertBloc`: 전문가 상태 관리
  - `ExpertDashboardBloc`: 전문가 대시보드 상태 관리
  - `ExpertCertificationBloc`: 전문가 인증 상태 관리
  - `ReviewBloc`: 리뷰 상태 관리

### 2. 데이터 관리
- ✅ **Clean Architecture**: Domain, Data, Presentation 레이어 분리
- ✅ **Repository 패턴**: 데이터 소스 추상화
- ✅ **Firebase Firestore**: 
  - `users`: 사용자 정보
  - `expert_accounts`: 전문가 계정 정보
  - `expert_profiles`: 전문가 프로필 정보
  - `cases`: 사건 정보
  - `consultation_requests`: 상담 요청 정보
- ✅ **데이터 모델**: JSON 직렬화/역직렬화 지원

### 3. 라우팅
- ✅ **Named Routes**: AppRouter를 통한 라우팅 관리
- ✅ **쿼리 파라미터 지원**: 페이지 간 데이터 전달
- ✅ **동적 라우팅**: 상태에 따른 조건부 라우팅

### 4. UI/UX
- ✅ **반응형 디자인**: 다양한 화면 크기 지원
- ✅ **Material Design**: Material 3 디자인 시스템 적용
- ✅ **다국어 지원**: 한국어/영어 로케일 지원
- ✅ **커스텀 위젯**: 재사용 가능한 UI 컴포넌트

### 5. 하이브리드 앱 지원
- ✅ **플랫폼 분기**: `kIsWeb`을 사용한 모바일/웹 분기 처리
- ✅ **환경 변수 관리**:
  - 모바일: `.env` 파일에서 API 키 로드
  - 웹: `.env` 로드하지 않음 (서버에서 관리)
- ✅ **API 호출 분기**:
  - 모바일: OpenAI API 직접 호출
  - 웹: Supabase Edge Function 프록시 호출

---

## 📊 데이터베이스 구조

### 주요 컬렉션

1. **users**: 일반 사용자 정보
2. **expert_accounts**: 전문가 계정 정보
   - `isVerified`: 인증 여부
   - `status`: 계정 상태 (active/inactive)
3. **expert_profiles**: 전문가 프로필 상세 정보
   - 기본정보, 인적사항, 학력, 경력 등 모든 프로필 데이터
4. **cases**: 법률 상담 사건 정보
5. **consultation_requests**: 상담 예약 요청 정보

---

## 🔧 주요 설정

- **Flutter**: 3.38.x
- **Dart**: 3.5.x
- **State Management**: flutter_bloc 8.1.x
- **Backend**: Firebase (Auth, Firestore, Storage)
- **Architecture**: Clean Architecture
- **Platform**: Android, iOS, Web

---

## 📝 주요 개선 사항 (최근)

1. ✅ **프로필 완성률 동적 계산**: 하드코딩된 10% → 실제 필드 기반 계산
2. ✅ **DB 저장/로드 기능**: 기본정보, 인적사항 섹션에 저장 기능 추가
3. ✅ **인증된 전문가만 표시**: 전문가 목록 필터링 개선
4. ✅ **상담 예약 시스템**: 날짜/시간 선택 및 DB 저장 기능
5. ✅ **하이브리드 아키텍처**: 모바일/웹 분기 처리 및 API 키 관리 개선
6. ✅ **상태 관리 개선**: 전문가 목록이 사라지는 문제 해결 (캐싱 및 라이프사이클 관리)

---

## 🚀 향후 개발 예정 기능

- [ ] 리뷰 시스템 완성
- [ ] 푸시 알림
- [ ] 실시간 채팅
- [ ] 결제 시스템
- [ ] 전문가 검색 및 필터링 고도화
- [ ] 통계 및 분석 대시보드

---

**마지막 업데이트**: 2026-01-14


